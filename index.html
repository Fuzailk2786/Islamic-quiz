<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Islamic Questz - 2026</title>
    <link rel="manifest" href="manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #f8fafc; --card-bg: #ffffff; --text-main: #064e3b;
            --emerald: #065f46; --gold: #b45309; --soft-gold: #fef3c7;
            --border: #e2e8f0; --shadow: rgba(0,0,0,0.1);
        }
        [data-theme="dark"] {
            --bg-color: #0f172a; --card-bg: #1e293b; --text-main: #f1f5f9;
            --emerald: #10b981; --gold: #fbbf24; --soft-gold: #334155;
            --border: #334155; --shadow: rgba(0,0,0,0.4);
        }

        body { font-family: 'Poppins', sans-serif; background: var(--bg-color); margin: 0; color: var(--text-main); transition: 0.3s; }

        /* --- Animations --- */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Bismillah Overlay */
        #bismillah-overlay {
            position: fixed; inset: 0; background: #064e3b;
            display: flex; flex-direction: column; justify-content: center;
            align-items: center; z-index: 10000; transition: 1s;
        }
        .bismillah-text { color: #fbbf24; font-size: 2rem; margin-bottom: 20px; font-family: 'Cinzel'; opacity: 0; animation: fadeIn 2s forwards; }

        /* Sidebar Customization */
        #sidebar {
            position: fixed; right: -280px; top: 0; width: 280px; height: 100%;
            background: var(--card-bg); z-index: 2000; transition: 0.3s;
            box-shadow: -5px 0 15px var(--shadow); padding-top: 20px;
        }
        #sidebar.open { right: 0; }
        .profile-section { padding: 20px; text-align: center; border-bottom: 2px solid var(--gold); }
        .avatar { width: 80px; height: 80px; border-radius: 50%; background: var(--soft-gold); margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; font-size: 2rem; border: 2px solid var(--gold); position: relative; overflow: hidden;}
        #profile-img { width: 100%; height: 100%; object-fit: cover; display: none; }

        /* Main Menu */
        .nav-item { padding: 12px 25px; display: flex; align-items: center; gap: 10px; color: var(--text-main); text-decoration: none; cursor: pointer; border-bottom: 1px solid var(--border); }
        .nav-item:hover { background: var(--soft-gold); }

        /* Grid & Cards */
        .mode-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .main-btn { background: var(--card-bg); border: 1px solid var(--border); padding: 20px; border-radius: 20px; cursor: pointer; transition: 0.2s; box-shadow: 0 4px 10px var(--shadow); }
        .main-btn:hover { transform: translateY(-5px); border-color: var(--gold); }
        .main-btn i { font-size: 1.5rem; display: block; margin-bottom: 10px; }

        /* Auth Screen */
        #screen-auth { padding: 40px 20px; text-align: center; }
        .auth-input { width: 80%; padding: 12px; margin: 10px 0; border-radius: 10px; border: 1px solid var(--border); }

        .hidden { display: none; }
        #menu-btn { position: fixed; top: 15px; right: 15px; font-size: 1.8rem; z-index: 2001; cursor: pointer; background: var(--gold); color: white; border: none; border-radius: 8px; width: 45px; height: 45px; }
    </style>
</head>
<body>

    <div id="bismillah-overlay">
        <div class="bismillah-text">Ø¨ÙØ³Ù’Ù…Ù Ù±Ù„Ù„ÙÙ‘Ù°Ù‡Ù Ù±Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ù±Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù</div>
        <div style="color: white; letter-spacing: 2px;">ISLAMIC QUESTZ</div>
    </div>

    <button id="menu-btn" class="hidden" onclick="toggleMenu()">â˜°</button>
    <nav id="sidebar">
        <div class="profile-section">
            <div class="avatar" onclick="document.getElementById('upload-pic').click()">
                <span id="avatar-init">?</span>
                <img id="profile-img" src="" alt="Profile">
            </div>
            <input type="file" id="upload-pic" class="hidden" accept="image/*" onchange="uploadImage(this)">
            <div id="user-display-name" style="font-weight: 600; margin-top: 5px;">Guest User</div>
        </div>
        <div class="nav-item" onclick="showScreen('home')">ğŸ  Home</div>
        <div class="nav-item" onclick="showScreen('ramadan-grid')">ğŸŒ™ Ramadan Quiz</div>
        <div class="nav-item" onclick="showScreen('regular-grid')">ğŸ“– Knowledge & Learning</div>
        <div class="nav-item" onclick="showHadith()">ğŸ“œ Hadith of the Day</div>
        <div class="nav-item" onclick="showScreen('duas')">ğŸ¤² Daily Duas</div>
        <div class="nav-item" onclick="showScreen('feedback')">ğŸ’¡ Feedback</div>
        <div class="nav-item" onclick="shareApp()">ğŸ“¤ Invite Friends</div>
        <div class="nav-item" onclick="toggleTheme()">ğŸŒ“ Theme Mode</div>
    </nav>

    <div id="main-container" class="hidden">
        <div class="app-card" style="margin: 0 auto; max-width: 500px; padding: 20px;">
            
            <div id="screen-auth">
                <h2 style="font-family: 'Cinzel';">Welcome</h2>
                <div id="login-box">
                    <input type="email" id="auth-email" class="auth-input" placeholder="Enter Email">
                    <button class="main-btn" style="width: 85%; background: var(--emerald); color: white;" onclick="handleAuth('register')">Register & Login</button>
                    <div style="margin: 15px 0;">OR</div>
                    <button class="main-btn" style="width: 85%; background: var(--gold); color: white;" onclick="handleAuth('guest')">Continue as Guest</button>
                </div>
            </div>

            <div id="screen-home" class="hidden">
                <h1 style="font-family: 'Cinzel';">Islamic Questz</h1>
                <div class="mode-grid">
                    <div class="main-btn" onclick="showScreen('ramadan-grid')">ğŸŒ™<br>Ramadan Quiz</div>
                    <div class="main-btn" onclick="showScreen('regular-grid')">ğŸ“–<br>Learning</div>
                    <div class="main-btn" onclick="showHadith()">ğŸ“œ<br>Daily Hadith</div>
                    <div class="main-btn" onclick="showScreen('duas')">ğŸ¤²<br>Daily Duas</div>
                </div>
                <button id="install-btn" class="main-btn" style="width: 100%; margin-top: 20px; background: #3b82f6; color: white;">ğŸ“² Install App</button>
            </div>

            <div id="screen-content" class="hidden">
                <button class="back-btn" onclick="showScreen('home')">â† Back</button>
                <div id="dynamic-body"></div>
            </div>

        </div>
    </div>

    <script>
        // --- 1. INITIALIZATION & BISMILLAH ---
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.getElementById('bismillah-overlay').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('bismillah-overlay').classList.add('hidden');
                    document.getElementById('main-container').classList.remove('hidden');
                    checkExistingLogin();
                }, 800);
            }, 2500);
        });

        // --- 2. AUTH LOGIC ---
        function handleAuth(type) {
            let user = { name: "", avatar: "ğŸŒ™", theme: "light" };
            if(type === 'guest') {
                user.name = "Guest_" + Math.floor(Math.random() * 9000);
            } else {
                const email = document.getElementById('auth-email').value;
                if(!email.includes('@')) return alert("Please enter valid email");
                user.name = email.split('@')[0];
            }
            localStorage.setItem('iq_user', JSON.stringify(user));
            loginUser(user);
        }

        function loginUser(user) {
            document.getElementById('screen-auth').classList.add('hidden');
            document.getElementById('screen-home').classList.remove('hidden');
            document.getElementById('menu-btn').classList.remove('hidden');
            document.getElementById('user-display-name').innerText = user.name;
            document.getElementById('avatar-init').innerText = user.name[0].toUpperCase();
        }

        function checkExistingLogin() {
            const saved = localStorage.getItem('iq_user');
            if(saved) loginUser(JSON.parse(saved));
        }

        // --- 3. SIDEBAR & THEME ---
        function toggleMenu() { document.getElementById('sidebar').classList.toggle('open'); }
        function toggleTheme() {
            const current = document.body.getAttribute('data-theme');
            const target = current === 'dark' ? 'light' : 'dark';
            document.body.setAttribute('data-theme', target);
        }

        // --- 4. SCREEN NAVIGATION ---
        function showScreen(screenId) {
            const screens = ['screen-auth', 'screen-home', 'screen-content'];
            screens.forEach(s => document.getElementById(s).classList.add('hidden'));
            
            if(screenId === 'ramadan-grid') {
                renderRamadanGrid();
                document.getElementById('screen-content').classList.remove('hidden');
            } else {
                document.getElementById('screen-' + screenId).classList.remove('hidden');
            }
            if(document.getElementById('sidebar').classList.contains('open')) toggleMenu();
        }

        // --- 5. RAMADAN 2026 DAILY UNLOCK LOGIC ---
        function renderRamadanGrid() {
            const container = document.getElementById('dynamic-body');
            container.innerHTML = '<h2>Ramadan 30-Day Challenge</h2><div class="level-grid" id="grid"></div>';
            const grid = document.getElementById('grid');
            
            // Start of Ramadan 2026 is approx March 1st (Check local moon)
            const ramadanStart = new Date('2026-03-01'); 
            const today = new Date();
            const diffDays = Math.floor((today - ramadanStart) / (1000 * 60 * 60 * 24)) + 1;

            for(let i=1; i<=30; i++) {
                const btn = document.createElement('button');
                btn.className = 'lvl';
                btn.innerText = i;
                if(i > diffDays) {
                    btn.classList.add('locked');
                    btn.innerHTML = i + " ğŸ”’";
                    btn.onclick = () => alert("This level will unlock on Ramadan Day " + i);
                } else {
                    btn.onclick = () => startRamadanLevel(i);
                }
                grid.appendChild(btn);
            }
        }

        // --- 6. UTILITIES ---
        function uploadImage(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    document.getElementById('profile-img').src = e.target.result;
                    document.getElementById('profile-img').style.display = 'block';
                    document.getElementById('avatar-init').style.display = 'none';
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function shareApp() {
            if (navigator.share) {
                navigator.share({ title: 'Islamic Questz', url: window.location.href });
            }
        }
    </script>
</body>
</html>
