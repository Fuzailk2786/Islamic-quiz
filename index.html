<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Islamic Questz - Knowledge Journey</title>
    <link rel="manifest" href="manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #f0f4f0; --card-bg: #ffffff; --text-main: #064e3b;
            --emerald: #065f46; --gold: #b45309; --soft-gold: #fef3c7;
            --border: #d1d5db; --shadow: rgba(0,0,0,0.1);
            --whatsapp: #25D366; --error: #b91c1c;
            --blue: #1e40af; --purple: #6b21a8;
        }
        [data-theme="dark"] {
            --bg-color: #020617; --card-bg: #1e293b; --text-main: #f1f5f9;
            --emerald: #10b981; --gold: #fbbf24; --soft-gold: #334155;
            --border: #475569; --shadow: rgba(0,0,0,0.5);
        }

        #bismillah-overlay {
            position: fixed; inset: 0; background: #064e3b;
            display: flex; flex-direction: column; justify-content: center;
            align-items: center; z-index: 10000; transition: opacity 1.5s ease;
        }
        
        #start-trigger {
            padding: 18px 40px; background: #fbbf24; color: #064e3b;
            border: none; border-radius: 50px; font-weight: 700; cursor: pointer;
            font-size: 1.2rem; box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        .bismillah-text {
            font-family: 'Cinzel', serif; font-size: 2.2rem; color: #fbbf24; 
            text-align: center; direction: rtl; display: none;
            text-shadow: 0 0 25px rgba(251, 191, 36, 0.6);
            animation: bismillahFade 4s ease-in-out forwards;
        }

        @keyframes bismillahFade {
            0% { opacity: 0; transform: scale(0.8); }
            40% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(1.1); }
        }

        body { font-family: 'Poppins', sans-serif; background: var(--bg-color); margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; transition: background 0.3s; padding: 20px 0; }
        #quiz-card { background: var(--card-bg); width: 90%; max-width: 500px; padding: 1.5rem; border-radius: 24px; box-shadow: 0 20px 40px var(--shadow); text-align: center; position: relative; transition: background 0.3s; min-height: 500px; }
        
        #theme-toggle { position: absolute; top: 15px; right: 15px; background: none; border: none; font-size: 1.5rem; cursor: pointer; z-index: 10; }

        /* Mode Selection Cards */
        .mode-card { padding: 20px; border-radius: 18px; color: white; margin-bottom: 15px; cursor: pointer; transition: transform 0.2s; position: relative; text-align: left; overflow: hidden; }
        .mode-card:hover { transform: translateY(-3px); }
        .mode-ramadan { background: linear-gradient(135deg, #065f46, #064e3b); border: 2px solid var(--gold); }
        .mode-regular { background: linear-gradient(135deg, #1e3a8a, #1e40af); }

        .category-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
        .cat-btn { background: var(--soft-gold); border: 1px solid var(--gold); padding: 15px; border-radius: 12px; font-weight: 600; color: var(--gold); cursor: pointer; font-size: 0.85rem; }

        .quote-container { margin: 15px 0; padding: 10px; border-radius: 15px; background: rgba(180, 83, 9, 0.05); border-left: 4px solid var(--gold); }
        .quote-urdu { font-size: 1.1rem; font-weight: 600; color: var(--emerald); direction: rtl; }

        .level-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin: 15px 0; }
        .level-btn { padding: 12px 5px; border-radius: 10px; border: 2px solid var(--emerald); background: none; color: var(--text-main); font-weight: 600; cursor: pointer; font-size: 0.8rem; }
        .level-btn.locked { opacity: 0.3; cursor: not-allowed; }
        .level-btn.completed { background: var(--emerald); color: white; }
        
        .option-btn { width: 100%; padding: 12px; margin: 6px 0; border-radius: 12px; border: 1px solid var(--border); background: var(--card-bg); color: var(--text-main); cursor: pointer; font-weight: 500; text-align: left; padding-left: 20px; }
        .option-btn:hover { background: var(--soft-gold); }

        .btn-action { background: var(--emerald); color: white; border: none; padding: 14px; width: 100%; border-radius: 8px; font-weight: 600; cursor: pointer; margin-top: 10px; }
        .btn-whatsapp { background: var(--whatsapp); color: white; border: none; padding: 14px; width: 100%; border-radius: 8px; font-weight: 600; cursor: pointer; margin-top: 10px; display: flex; align-items: center; justify-content: center; gap: 8px; text-decoration: none; }
        #btn-install { background: #3b82f6; color: white; border: none; padding: 10px; width: 100%; border-radius: 8px; font-weight: 600; cursor: pointer; margin-top: 15px; display: none; }

        /* Deep Dive Hadith View */
        .hadith-box { background: var(--soft-gold); padding: 15px; border-radius: 12px; border-left: 4px solid var(--gold); text-align: left; margin-top: 15px; font-size: 0.9rem; color: var(--gold); line-height: 1.5; }
        
        .hidden { display: none; }
        .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); justify-content: center; align-items: center; z-index: 1000; }
        .modal { background: var(--card-bg); padding: 1.5rem; border-radius: 20px; max-width: 400px; width: 90%; border-top: 5px solid var(--gold); overflow-y: auto; max-height: 80vh; }
    </style>
</head>
<body data-theme="light">

    <div id="bismillah-overlay">
        <button id="start-trigger">Begin Islamic Questz</button>
        <div class="bismillah-text" id="b-text">ÿ®Ÿêÿ≥ŸíŸÖŸê Ÿ±ŸÑŸÑŸéŸëŸ∞ŸáŸê Ÿ±ŸÑÿ±ŸéŸëÿ≠ŸíŸÖŸéŸ∞ŸÜŸê Ÿ±ŸÑÿ±ŸéŸëÿ≠ŸêŸäŸÖŸê</div>
    </div>

    <div id="quiz-card">
        <button id="theme-toggle" onclick="toggleTheme()">üåì</button>

        <!-- Screen 1: Home / Mode Selection -->
        <div id="screen-home">
            <h1 style="font-family: 'Cinzel', serif; color: var(--text-main); margin-bottom: 20px;">Islamic Questz</h1>
            
            <div class="mode-card mode-ramadan" onclick="switchMode('ramadan')">
                <h3 class="margin-0">Ramadan Challenge</h3>
                <p style="font-size: 0.8rem; opacity: 0.9;">30 Days ‚Ä¢ 150 Questions ‚Ä¢ Weekly Rewards</p>
                <div style="position:absolute; right: -10px; bottom: -10px; opacity: 0.2; font-size: 4rem;">üåô</div>
            </div>

            <div class="mode-card mode-regular" onclick="switchMode('regular')">
                <h3 class="margin-0">Knowledge Pathways</h3>
                <p style="font-size: 0.8rem; opacity: 0.9;">Quran, Hadith, Seerah & History</p>
                <div style="position:absolute; right: -10px; bottom: -10px; opacity: 0.2; font-size: 4rem;">üìñ</div>
            </div>

            <div class="quote-container">
                <div class="quote-urdu" id="u-quote">...</div>
                <div style="font-size: 0.8rem; font-style: italic;" id="h-quote">...</div>
            </div>

            <button id="btn-install">üì≤ Install App</button>
        </div>

        <!-- Screen 2: Ramadan Levels -->
        <div id="screen-ramadan-levels" class="hidden">
            <button onclick="showHome()" style="float: left; background: none; border: none; color: var(--gold); font-weight: bold; cursor: pointer;">‚Üê Back</button>
            <h2 style="color: var(--emerald);">Ramadan 2026</h2>
            <div id="fast-counter" style="font-size: 0.8rem; color: var(--gold); font-weight: bold;"></div>
            <div class="level-grid" id="ramadan-grid"></div>
        </div>

        <!-- Screen 3: Regular Categories -->
        <div id="screen-regular-cats" class="hidden">
            <button onclick="showHome()" style="float: left; background: none; border: none; color: var(--blue); font-weight: bold; cursor: pointer;">‚Üê Back</button>
            <h2 style="color: var(--blue);">General Knowledge</h2>
            <div class="category-grid">
                <button class="cat-btn" onclick="startRegular('Quran')">üìñ Al-Quran</button>
                <button class="cat-btn" onclick="startRegular('Hadith')">üìú Hadith</button>
                <button class="cat-btn" onclick="startRegular('History')">üïå History</button>
                <button class="cat-btn" onclick="startRegular('Sahaba')">‚öîÔ∏è Sahaba</button>
            </div>
        </div>

        <!-- Screen 4: Quiz Play -->
        <div id="screen-quiz" class="hidden">
            <p id="q-meta" style="color: var(--gold); font-size: 0.8rem; font-weight: 700;"></p>
            <h3 id="q-text" style="color: var(--text-main); margin-bottom: 20px;"></h3>
            <div id="opt-container"></div>
        </div>

        <!-- Screen 5: Result -->
        <div id="screen-result" class="hidden">
            <h2 id="res-score" style="font-size: 2.5rem; color: var(--text-main);"></h2>
            <p id="res-msg"></p>
            <a id="whatsapp-share" class="btn-whatsapp" target="_blank">Share Progress</a>
            <button class="btn-action" onclick="showHome()">Return Home</button>
        </div>
    </div>

    <!-- Explanation Modal -->
    <div id="modal-explain" class="modal-overlay">
        <div class="modal">
            <h3 id="m-title">Correct!</h3>
            <p id="m-answer" style="font-weight: bold; color: var(--emerald);"></p>
            <div class="hadith-box" id="m-explain"></div>
            <button class="btn-action" onclick="closeModal()">Next Question</button>
        </div>
    </div>

    <script>
        const RAMADAN_START = new Date('2026-02-18');
        let currentMode = 'ramadan'; 
        let currentCat = '';
        let qIdx = 0, score = 0, curLvl = 1;
        
        // --- DATABASE STRUCTURE ---
        const db = {
            ramadan: [
                { q: "What is the primary purpose of fasting in Ramadan?", o: ["To lose weight", "To attain Taqwa (God-consciousness)", "To save food", "To sleep more"], a: "To attain Taqwa (God-consciousness)", e: "As mentioned in Surah Al-Baqarah (2:183), fasting is prescribed so that you may become righteous." },
                { q: "Which battle took place in the month of Ramadan?", o: ["Battle of Uhud", "Battle of Badr", "Battle of Khandaq", "Battle of Hunayn"], a: "Battle of Badr", e: "The Battle of Badr occurred on the 17th of Ramadan in the 2nd year of Hijrah." },
                // ... (Load remaining 148 here)
            ],
            regular: {
                Quran: [
                    { q: "How many Surahs are in the Quran?", o: ["110", "114", "120", "112"], a: "114", e: "The Quran contains 114 Surahs, divided into Makki and Madani." },
                    // ... (Load 79 more)
                ],
                Hadith: [
                    { q: "Who compiled the most authentic book of Hadith?", o: ["Imam Muslim", "Imam Bukhari", "Imam Malik", "Imam Tirmidhi"], a: "Imam Bukhari", e: "Sahih Al-Bukhari is considered the most authentic book after the Quran." },
                    // ... (Load 49 more)
                ],
                History: [
                    { q: "Who was the first Caliph?", o: ["Umar", "Ali", "Abu Bakr", "Uthman"], a: "Abu Bakr", e: "Abu Bakr As-Siddiq was the first of the four Rightly Guided Caliphs." }
                ],
                Sahaba: [
                    { q: "Which Sahabi was known as the 'Sword of Allah'?", o: ["Umar ibn Khattab", "Khalid ibn al-Walid", "Ali ibn Abi Talib", "Hamza"], a: "Khalid ibn al-Walid", e: "The Prophet (PBUH) gave him the title 'Saifullah' after the Battle of Mu'tah." }
                ]
            }
        };

        // --- CORE LOGIC ---
        function toggleTheme() {
            const body = document.body;
            body.setAttribute('data-theme', body.getAttribute('data-theme') === 'light' ? 'dark' : 'light');
        }

        function getCurrentDay() {
            const diff = Math.floor((new Date() - RAMADAN_START) / (1000 * 60 * 60 * 24)) + 1;
            return Math.max(0, Math.min(30, diff));
        }

        function showHome() {
            document.querySelectorAll('#quiz-card > div').forEach(d => d.classList.add('hidden'));
            document.getElementById('screen-home').classList.remove('hidden');
            updateQuotes();
        }

        function switchMode(mode) {
            document.getElementById('screen-home').classList.add('hidden');
            if(mode === 'ramadan') {
                document.getElementById('screen-ramadan-levels').classList.remove('hidden');
                renderRamadanLevels();
            } else {
                document.getElementById('screen-regular-cats').classList.remove('hidden');
            }
        }

        function renderRamadanLevels() {
            const grid = document.getElementById('ramadan-grid');
            const day = getCurrentDay() || 1;
            grid.innerHTML = '';
            for(let i=1; i<=30; i++) {
                const btn = document.createElement('button');
                btn.className = 'level-btn';
                btn.innerText = i;
                if(i > day) btn.classList.add('locked');
                else btn.onclick = () => startQuiz('ramadan', i);
                grid.appendChild(btn);
            }
            document.getElementById('fast-counter').innerText = `Current Status: Day ${day} of 30`;
        }

        function startQuiz(mode, lvl, cat = '') {
            currentMode = mode; curLvl = lvl; currentCat = cat;
            qIdx = 0; score = 0;
            document.querySelectorAll('#quiz-card > div').forEach(d => d.classList.add('hidden'));
            document.getElementById('screen-quiz').classList.remove('hidden');
            loadQuestion();
        }

        function startRegular(cat) {
            startQuiz('regular', 1, cat);
        }

        function loadQuestion() {
            const data = currentMode === 'ramadan' ? db.ramadan : db.regular[currentCat];
            const q = data[qIdx];
            
            document.getElementById('q-meta').innerText = currentMode === 'ramadan' ? `Ramadan Day ${curLvl} - Q${qIdx+1}` : `${currentCat} - Q${qIdx+1}`;
            document.getElementById('q-text').innerText = q.q;
            
            const container = document.getElementById('opt-container');
            container.innerHTML = '';
            q.o.forEach(opt => {
                const b = document.createElement('button');
                b.className = 'option-btn';
                b.innerText = opt;
                b.onclick = () => handleAnswer(opt, q);
                container.appendChild(b);
            });
        }

        function handleAnswer(sel, qData) {
            const isCorrect = sel === qData.a;
            if(isCorrect) score++;
            
            document.getElementById('m-title').innerText = isCorrect ? "‚úÖ Correct!" : "‚ùå Incorrect";
            document.getElementById('m-answer').innerText = `Answer: ${qData.a}`;
            document.getElementById('m-explain').innerText = qData.e;
            document.getElementById('modal-explain').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('modal-explain').style.display = 'none';
            qIdx++;
            const data = currentMode === 'ramadan' ? db.ramadan : db.regular[currentCat];
            
            if(qIdx < 5 && qIdx < data.length) {
                loadQuestion();
            } else {
                showResult();
            }
        }

        function showResult() {
            document.getElementById('screen-quiz').classList.add('hidden');
            document.getElementById('screen-result').classList.remove('hidden');
            document.getElementById('res-score').innerText = `${score}/5`;
            
            const shareText = `I scored ${score}/5 on Islamic Questz (${currentMode})! Challenge yourself this Ramadan üåô`;
            document.getElementById('whatsapp-share').href = `https://wa.me/?text=${encodeURIComponent(shareText)}`;
        }

        function updateQuotes() {
            const quotes = [
                { u: "ÿπŸÑŸÖ ÿ≠ÿßÿµŸÑ ⁄©ÿ±ŸÜÿß €Åÿ± ŸÖÿ≥ŸÑŸÖÿßŸÜ Ÿæÿ± ŸÅÿ±ÿ∂ €Å€í", h: "Ilm hasil karna har musalman par farz hai." },
                { u: "ŸÜŸÖÿßÿ≤ ŸÖŸàŸÖŸÜ ⁄©€å ŸÖÿπÿ±ÿßÿ¨ €Å€í", h: "Namaz momin ki mairaaj hai." }
            ];
            const q = quotes[Math.floor(Math.random()*quotes.length)];
            document.getElementById('u-quote').innerText = q.u;
            document.getElementById('h-quote').innerText = q.h;
        }

        // Bismillah Overlay
        document.getElementById('start-trigger').onclick = function() {
            this.style.display = 'none';
            document.getElementById('b-text').style.display = 'block';
            setTimeout(() => {
                document.getElementById('bismillah-overlay').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('bismillah-overlay').style.display = 'none';
                    showHome();
                }, 1000);
            }, 3500);
        };
    </script>
</body>
</html>

